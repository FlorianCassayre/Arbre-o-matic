!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).parseGedcom=e()}}(function(){return function(){return function e(n,t,r){function o(i,f){if(!t[i]){if(!n[i]){var l="function"==typeof require&&require;if(!f&&l)return l(i,!0);if(u)return u(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var p=t[i]={exports:{}};n[i][0].call(p.exports,function(e){return o(n[i][1][e]||e)},p,p.exports,e,n,t,r)}return t[i].exports}for(var u="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}}()({1:[function(e,n,t){function r(e){return function(n){return n.tag===e}}function o(e){return e.id=e.pointer,e.name=function(e){if("INDI"!==e.tag)return"Family";var n=(e.tree.filter(r("NAME"))||[])[0];return n?n.data.replace(/\//g,""):void 0}(e),e}n.exports=function(e){var n=e.filter(r("INDI")).map(o),t=e.filter(r("FAM")),u=t.map(o),i=t.reduce(function(e,n){return e.concat(function(e){return e.tree.filter(function(e){return e.data&&"@"===e.data[0]}).map(function(n){return{source:e.pointer,target:n.data}})}(n))},[]),f=n.concat(u),l=f.reduce(function(e,n,t){return e[n.id]=t,e},{});return{nodes:f,links:i=i.map(function(e){return function(n){function t(n){return e[n]}return{source:t(n.source),target:t(n.target)}}}(l))}}},{}],2:[function(e,n,t){var r=e("traverse"),o=/\s*(0|[1-9]+[0-9]*) (@[^@]+@ |)([A-Za-z0-9_]+)( [^\n\r]*|)/;n.exports.parse=function(e){var n={root:{tree:[]},level:0};return n.pointer=n.root,r(e.split("\n").map(function(e){var n=e.match(o);return n?{level:parseInt(n[1],10),pointer:n[2].trim(),tag:n[3].trim(),data:n[4].trim(),tree:[]}:null}).filter(function(e){return e}).reduce(function(e,n){if(n.level===e.level)e.pointer.tree.push(n);else if(n.level>e.level){var t=e.pointer;e.pointer=e.pointer.tree[e.pointer.tree.length-1],e.pointer.tree.push(n),e.pointer.up=t,e.level=n.level}else if(n.level<e.level){for(;n.level<=e.pointer.level&&e.pointer.up;)e.pointer=e.pointer.up;e.pointer.tree.push(n),e.level=n.level}return e},n).root.tree).map(function(e){delete e.up,delete e.level,this.update(e)})},n.exports.d3ize=e("./d3ize")},{"./d3ize":1,traverse:3}],3:[function(e,n,t){var r=n.exports=function(e){return new o(e)};function o(e){this.value=e}function u(e,n,t){var r=[],o=[],u=!0;return function e(l){var v=t?i(l):l,h={},d=!0,s={node:v,node_:l,path:[].concat(r),parent:o[o.length-1],parents:o,key:r.slice(-1)[0],isRoot:0===r.length,level:r.length,circular:null,update:function(e,n){s.isRoot||(s.parent.node[s.key]=e),s.node=e,n&&(d=!1)},delete:function(e){delete s.parent.node[s.key],e&&(d=!1)},remove:function(e){c(s.parent.node)?s.parent.node.splice(s.key,1):delete s.parent.node[s.key],e&&(d=!1)},keys:null,before:function(e){h.before=e},after:function(e){h.after=e},pre:function(e){h.pre=e},post:function(e){h.post=e},stop:function(){u=!1},block:function(){d=!1}};if(!u)return s;function y(){if("object"==typeof s.node&&null!==s.node){s.keys&&s.node_===s.node||(s.keys=f(s.node)),s.isLeaf=0==s.keys.length;for(var e=0;e<o.length;e++)if(o[e].node_===l){s.circular=o[e];break}}else s.isLeaf=!0,s.keys=null;s.notLeaf=!s.isLeaf,s.notRoot=!s.isRoot}y();var g=n.call(s,s.node);return void 0!==g&&s.update&&s.update(g),h.before&&h.before.call(s,s.node),d?("object"!=typeof s.node||null===s.node||s.circular||(o.push(s),y(),p(s.keys,function(n,o){r.push(n),h.pre&&h.pre.call(s,s.node[n],n);var u=e(s.node[n]);t&&a.call(s.node,n)&&(s.node[n]=u.node),u.isLast=o==s.keys.length-1,u.isFirst=0==o,h.post&&h.post.call(s,u),r.pop()}),o.pop()),h.after&&h.after.call(s,s.node),s):s}(e).node}function i(e){if("object"==typeof e&&null!==e){var n;if(c(e))n=[];else if("[object Date]"===l(e))n=new Date(e.getTime?e.getTime():e);else if(function(e){return"[object RegExp]"===l(e)}(e))n=new RegExp(e);else if(function(e){return"[object Error]"===l(e)}(e))n={message:e.message};else if(function(e){return"[object Boolean]"===l(e)}(e))n=new Boolean(e);else if(function(e){return"[object Number]"===l(e)}(e))n=new Number(e);else if(function(e){return"[object String]"===l(e)}(e))n=new String(e);else if(Object.create&&Object.getPrototypeOf)n=Object.create(Object.getPrototypeOf(e));else if(e.constructor===Object)n={};else{var t=e.constructor&&e.constructor.prototype||e.__proto__||{},r=function(){};r.prototype=t,n=new r}return p(f(e),function(t){n[t]=e[t]}),n}return e}o.prototype.get=function(e){for(var n=this.value,t=0;t<e.length;t++){var r=e[t];if(!n||!a.call(n,r)){n=void 0;break}n=n[r]}return n},o.prototype.has=function(e){for(var n=this.value,t=0;t<e.length;t++){var r=e[t];if(!n||!a.call(n,r))return!1;n=n[r]}return!0},o.prototype.set=function(e,n){for(var t=this.value,r=0;r<e.length-1;r++){var o=e[r];a.call(t,o)||(t[o]={}),t=t[o]}return t[e[r]]=n,n},o.prototype.map=function(e){return u(this.value,e,!0)},o.prototype.forEach=function(e){return this.value=u(this.value,e,!1),this.value},o.prototype.reduce=function(e,n){var t=1===arguments.length,r=t?this.value:n;return this.forEach(function(n){this.isRoot&&t||(r=e.call(this,r,n))}),r},o.prototype.paths=function(){var e=[];return this.forEach(function(n){e.push(this.path)}),e},o.prototype.nodes=function(){var e=[];return this.forEach(function(n){e.push(this.node)}),e},o.prototype.clone=function(){var e=[],n=[];return function t(r){for(var o=0;o<e.length;o++)if(e[o]===r)return n[o];if("object"==typeof r&&null!==r){var u=i(r);return e.push(r),n.push(u),p(f(r),function(e){u[e]=t(r[e])}),e.pop(),n.pop(),u}return r}(this.value)};var f=Object.keys||function(e){var n=[];for(var t in e)n.push(t);return n};function l(e){return Object.prototype.toString.call(e)}var c=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},p=function(e,n){if(e.forEach)return e.forEach(n);for(var t=0;t<e.length;t++)n(e[t],t,e)};p(f(o.prototype),function(e){r[e]=function(n){var t=[].slice.call(arguments,1),r=new o(n);return r[e].apply(r,t)}});var a=Object.hasOwnProperty||function(e,n){return n in e}},{}]},{},[2])(2)});